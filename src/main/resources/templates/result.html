<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verdict Result - OfferVerdict</title>
    <meta name="robots" content="index, follow">

    <!-- Unified Design System -->
    <link rel="stylesheet" href="/css/dashboard.css">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Courier+Prime:wght@400;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- SEO Meta -->
    <meta name="description" th:content="${metaDescription}">
    <link rel="canonical" th:href="${canonicalUrl}">
    <meta property="og:title" th:content="${ogTitle}">
    <meta property="og:description" th:content="${ogDescription}">
    <meta property="og:url" th:content="${ogUrl}">
    <meta property="og:image" th:content="${ogImageUrl}">

    <!-- Structured Data -->
    <script type="application/ld+json" th:utext="${structuredDataJson}"></script>

    <!-- Analytics -->
    <div th:replace="~{fragments/analytics :: analytics}"></div>

    <!-- Share Generation -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>

<body>

    <div class="verdict-container">

        <!-- COMMAND HEADER -->
        <header style="margin-bottom: 2rem; display: flex; justify-content: space-between; align-items: center;">
            <div class="logo" style="font-weight: 900; font-size: 1.2rem;">OfferVerdict</div>
            <a href="/" class="btn btn-glass" style="font-size: 0.8rem;">‚Üê New Analysis</a>
        </header>

        <!-- PART 1: THE RECEIPT (Verdict) -->
        <div class="receipt-card animate-in">
            <div class="receipt-header">
                <span>OFFER VERDICT RECEIPT</span>
                <span>ID: #OV-2026-<span th:text="${#strings.randomAlphanumeric(4)}">A7B9</span></span>
            </div>

            <div class="verdict-hero">
                <div id="verdict-badge" class="verdict-badge"
                    th:classappend="${result.verdict.name() == 'GO'} ? 'verdict-go' : 'verdict-nogo'"
                    th:text="${result.verdict}">GO</div>

                <div class="core-numbers">
                    <div class="number-item">
                        <span class="number-value gradient-text" id="net-gain-display"
                            th:text="${result.monthlyGainStr}">+$2,102</span>
                        <span class="number-label">Monthly Gain</span>
                    </div>
                    <!-- Vertical Divider -->
                    <div style="width: 1px; background: #e2e8f0;"></div>
                    <div class="number-item">
                        <span class="number-value" style="color: #4a5568;" id="freedom-display"
                            th:text="${result.freedomIndex}">25%</span>
                        <span class="number-label">Freedom Index</span>
                    </div>
                </div>

                <div style="font-size: 0.9rem; color: #718096; margin-top: 5px;">
                    <span style="background: #edf2f7; padding: 2px 8px; border-radius: 4px;">Verified vs Market</span>
                    Comparable to Top <span style="font-weight: 700; color: #2d3748;"
                        th:text="${result.jobPercentile}">22%</span> üìä BLS
                </div>
            </div>

            <!-- WHY SECTION (Data Authority) -->
            <div class="why-section">
                <h4
                    style="margin-bottom: 1rem; color: var(--text-tertiary); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.05em;">
                    Why This Verdict? (Irrefutable Data)</h4>
                <ul class="why-list">
                    <li class="why-item">
                        <span class="why-icon">üèõÔ∏è</span>
                        <div>
                            <div style="font-weight: 700;">Tax Impact</div>
                            <div style="font-size: 0.9rem;">
                                <span th:text="${result.taxDiffMsg}">San Francisco takes $847 more/mo than Austin</span>
                                <span class="source-badge">IRS 2026</span>
                            </div>
                        </div>
                    </li>
                    <li class="why-item">
                        <span class="why-icon">üè†</span>
                        <div>
                            <div style="font-weight: 700;">Rent Burden</div>
                            <div style="font-size: 0.9rem;">
                                <span th:text="${result.rentDiffMsg}">Rent jumps from 32% to 41% of income</span>
                                <span class="source-badge">Zillow</span>
                            </div>
                        </div>
                    </li>
                    <li class="why-item">
                        <span class="why-icon">üí∞</span>
                        <div>
                            <div style="font-weight: 700;">Real Value</div>
                            <div style="font-size: 0.9rem;">
                                <span th:text="${result.valueDiffMsg}">Real hourly value drops 12.3% adjusted for
                                    COL</span>
                                <span class="source-badge">BLS/Numbeo</span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- YOUR LIFE SECTION (Emotional) -->
            <div class="your-life-grid">
                <div class="life-card">
                    <div style="font-size: 1.5rem;">üè†</div>
                    <div class="life-value" id="housing-months"
                        th:text="${#numbers.formatInteger(result.offer.yearsToBuyHouse * 12, 0) + 'mo'}">42mo</div>
                    <div class="life-msg">To Buy House</div>
                </div>
                <div class="life-card">
                    <div style="font-size: 1.5rem;">üéì</div>
                    <div class="life-value" id="loan-payoff">--</div>
                    <div class="life-msg">Student Loan</div>
                </div>
                <div class="life-card">
                    <div style="font-size: 1.5rem;">üìà</div>
                    <div class="life-value" id="401k-status">YES</div>
                    <div class="life-msg">Max 401k</div>
                </div>
                <div class="life-card">
                    <div style="font-size: 1.5rem;">‚úàÔ∏è</div>
                    <div class="life-value" id="travel-trips"
                        th:text="${#numbers.formatInteger(result.offer.monthsToBuyTesla, 0)}">8</div>
                    <div class="life-msg">Tesla Months</div>
                </div>
                <div class="life-card">
                    <div style="font-size: 1.5rem;">üöó</div>
                    <div class="life-value" id="car-tier">BMW</div>
                    <div class="life-msg">Car Tier</div>
                </div>
                <div class="life-card">
                    <div style="font-size: 1.5rem;">üçΩÔ∏è</div>
                    <div class="life-value" id="dining-freq">28</div>
                    <div class="life-msg">Dining Out/mo</div>
                </div>
            </div>

            <div class="share-actions">
                <button class="btn btn-primary" id="share-btn">üì§ Download Receipt</button>
                <button class="btn btn-glass" onclick="window.print()">üñ®Ô∏è Print PDF</button>
            </div>

        </div> <!-- End Receipt -->


        <!-- PART 2: SIMULATOR -->
        <div class="simulator-container animate-in delay-2">
            <h3 style="text-align: center; margin-bottom: 1.5rem;">üéÆ "What If..." Simulator</h3>

            <!-- Presets -->
            <div class="preset-controls">
                <button class="preset-btn active" data-scenario="default">Default</button>
                <button class="preset-btn" data-scenario="roommate">+ Roommate</button>
                <button class="preset-btn" data-scenario="married">+ Married</button>
                <button class="preset-btn" data-scenario="max401k">Max 401k</button>
                <button class="preset-btn" data-scenario="optimize"
                    style="background: var(--text-primary); color: white;">‚ú® AI Optimize</button>
            </div>

            <!-- Sliders -->
            <div class="slider-group">
                <div class="slider-header">
                    <span class="slider-label">Proposed Salary</span>
                    <span class="slider-value" id="salary-val"
                        th:text="${#numbers.formatCurrency(offerSalary)}">$150,000</span>
                </div>
                <input type="range" id="salary-slider" min="80000" max="400000" step="1000"
                    th:value="${#numbers.formatDecimal(offerSalary, 0, 0)}">
                <div style="font-size: 0.8rem; color: #48bb78; margin-top: 5px;">
                    üí° Just $5k more for "Strong GO"
                </div>
            </div>

            <div class="slider-group">
                <div class="slider-header">
                    <span class="slider-label">401k Contribution</span>
                    <span class="slider-value" id="401k-val">5%</span>
                </div>
                <input type="range" id="401k-slider" min="0" max="25" step="1" value="5">
                <div style="font-size: 0.8rem; color: #718096; margin-top: 5px;">
                    Retirement acceleration: <span id="retirement-imp">Normal</span>
                </div>
            </div>

            <!-- Progress to GO -->
            <div class="progress-section">
                <h4 style="color: var(--text-secondary);">üéØ Progress to GO</h4>
                <div class="progress-bar-container">
                    <div class="progress-fill" id="progress-fill" style="width: 72%;"></div>
                </div>
                <p style="font-size: 0.9rem; color: var(--text-secondary);" id="progress-msg">
                    You are close to a clear GO verdict!
                </p>

                <div class="fomo-msg animate-in delay-3" th:if="${!result.isGoodSalary}">
                    ‚ö†Ô∏è Current offer is below market rate for <span th:text="${cityB.city}">Austin</span>.
                </div>

                <div class="simulation-counter">
                    üéØ Your Simulations: <span id="sim-count">1</span>/10 (Keep going for AI unlock)
                </div>
            </div>

            <!-- Affiliate / Action Buttons -->
            <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <a th:href="@{'https://www.linkedin.com/jobs/search?keywords=' + ${job.title} + '&location=' + ${cityB.city}}"
                    target="_blank" class="affiliate-btn">
                    <span>üíº</span> Find <span th:text="${job.title}">Jobs</span> in <span
                        th:text="${cityB.city}">Austin</span>
                </a>
                <a th:href="@{'https://www.google.com/search?q=moving+companies+' + ${cityA.city} + '+to+' + ${cityB.city}}"
                    target="_blank" class="affiliate-btn">
                    <span>üì¶</span> Movers to <span th:text="${cityB.city}">Austin</span>
                </a>
            </div>
        </div>

        <!-- Related Comparisons (pSEO Links) -->
        <div style="margin-top: 3rem;">
            <h4 style="text-align: center; margin-bottom: 1rem;">Compare Other Scenarios</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                <a th:each="link : ${otherCityLinks}" th:href="${link}" class="btn btn-glass"
                    style="font-size: 0.8rem;">
                    Compare <span th:text="${cityA.city}">SF</span> vs Others
                </a>
            </div>
        </div>

        <!-- DATA AUTHORITY FOOTER -->
        <footer>
            <div style="font-weight: 700; margin-bottom: 1rem;">Data Powered By:</div>
            <div class="data-sources-grid">
                <div class="source-item">üèõÔ∏è IRS Tax Tables 2026</div>
                <div class="source-item">üìã State Dept. Revenue</div>
                <div class="source-item">üè† Zillow Rent Index</div>
                <div class="source-item">üìä BLS Labor Stats</div>
                <div class="source-item">üåè Numbeo COL</div>
            </div>
            <div style="margin-top: 2rem; opacity: 0.6;">
                Last Data Sync: <span th:text="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}">2026-01-07</span> PST
                <br>
                <a href="#" style="color: inherit; text-decoration: underline;">How We Calculate</a>
            </div>
        </footer>

    </div>

    <script src="/js/dashboard.js"></script>
</body>

</html>